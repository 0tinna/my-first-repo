# Git 学习指南：从入门到实战

## 目录
1. [Git 基础概念](#1-git-基础概念)
2. [安装与配置](#2-安装与配置)
3. [基本工作流](#3-基本工作流)
4. [分支操作](#4-分支操作)
5. [远程仓库操作](#5-远程仓库操作)
6. [撤销与恢复](#6-撤销与恢复)
7. [高级操作](#7-高级操作)
8. [实际工作场景](#8-实际工作场景)
9. [Git 最佳实践](#9-git-最佳实践)

## 1. Git 基础概念

### 什么是 Git？
Git 是一个分布式版本控制系统，用于跟踪文件更改和协调多人协作开发。

### 基本概念
- **仓库（Repository）**: 存储项目文件及其历史记录
- **提交（Commit）**: 保存项目在某一时刻的快照
- **分支（Branch）**: 独立的开发线
- **工作区（Working Directory）**: 实际文件所在的目录
- **暂存区（Staging Area）**: 准备提交的文件区域
- **远程仓库（Remote Repository）**: 存储在服务器上的仓库

## 2. 安装与配置

### 安装 Git
根据您的操作系统选择安装方式：

**Windows**:
从 [https://git-scm.com/download/win](https://git-scm.com/download/win) 下载并安装

**macOS**:
```bash
# 使用 Homebrew
brew install git
```

**Linux (Ubuntu/Debian)**:
```bash
sudo apt-get update
sudo apt-get install git
```

### 初始配置
```bash
# 设置用户名和邮箱
git config --global user.name "您的名字"
git config --global user.email "您的邮箱@example.com"

# 查看配置
git config --list
```

## 3. 基本工作流

### 创建仓库
```bash
# 初始化新仓库
mkdir my-project
cd my-project
git init
```

### 基本操作流程

**1. 查看状态**
```bash
git status
```

**2. 添加文件到暂存区**
```bash
# 创建文件
echo "# My Project" > README.md

# 添加单个文件
git add README.md

# 添加所有文件
git add .
```

**3. 提交更改**
```bash
git commit -m "初始提交：添加 README 文件"
```

**4. 查看提交历史**
```bash
# 简洁历史
git log --oneline

# 详细历史
git log
```

### 完整基础流程示例
```bash
# 创建项目目录
mkdir hello-git
cd hello-git

# 初始化仓库
git init

# 创建文件
echo "# Hello Git" > README.md
echo "console.log('Hello, world!');" > app.js

# 查看状态
git status

# 添加文件到暂存区
git add .

# 再次查看状态
git status

# 提交更改
git commit -m "项目初始化"

# 查看提交历史
git log
```

## 4. 分支操作

### 分支基础
```bash
# 查看所有分支
git branch

# 创建新分支
git branch feature-login

# 切换到指定分支
git checkout feature-login

# 创建并切换到新分支（简写）
git checkout -b feature-signup

# 合并分支
git checkout main       # 先切换回目标分支
git merge feature-login # 将 feature-login 分支合并到当前分支
```

### 解决合并冲突
当两个分支修改了同一个文件的同一部分时，会产生冲突：
```bash
# 假设在合并时出现冲突
git merge feature-xyz

# Git 会显示冲突信息，编辑冲突文件
# 打开冲突文件，你会看到类似这样的标记：
# <<<<<<< HEAD
# 当前分支的内容
# =======
# 要合并的分支内容
# >>>>>>> feature-xyz

# 手动编辑文件解决冲突
# 解决后添加文件
git add 冲突文件.txt

# 完成合并
git commit -m "解决合并冲突"
```

### 分支操作实例
```bash
# 初始化仓库
mkdir branch-demo
cd branch-demo
git init
echo "# 主分支内容" > README.md
git add README.md
git commit -m "初始提交"

# 创建并切换到新功能分支
git checkout -b feature-a

# 在新分支上修改文件
echo "## 功能 A 开发中" >> README.md
git add README.md
git commit -m "在功能 A 分支添加内容"

# 切换回主分支
git checkout main

# 创建另一个分支
git checkout -b feature-b

# 在 feature-b 分支修改文件
echo "## 功能 B 开发中" >> README.md
git add README.md
git commit -m "在功能 B 分支添加内容"

# 切换回主分支，合并功能 A
git checkout main
git merge feature-a

# 合并功能 B（可能会有冲突）
git merge feature-b
```

## 5. 远程仓库操作

### 连接远程仓库
```bash
# 添加远程仓库
git remote add origin https://github.com/username/repository.git

# 查看远程仓库
git remote -v
```

### 推送与拉取
```bash
# 推送到远程仓库
git push -u origin main  # 第一次推送使用 -u 参数

# 后续推送
git push

# 从远程仓库拉取更新
git pull

# 或分开执行
git fetch  # 获取远程更新但不合并
git merge  # 合并更新
```

### 克隆远程仓库
```bash
git clone https://github.com/username/repository.git
```

### 远程仓库完整示例
```bash
# 假设已有本地仓库
cd my-project

# 添加远程仓库
git remote add origin https://github.com/username/my-project.git

# 查看远程仓库
git remote -v

# 推送本地 main 分支到远程
git push -u origin main

# 创建并切换到新分支
git checkout -b feature-xyz

# 进行更改
echo "新功能开发" > feature.txt
git add feature.txt
git commit -m "添加新功能"

# 推送新分支到远程
git push -u origin feature-xyz

# 在另一台电脑上克隆仓库
# (在新目录执行)
git clone https://github.com/username/my-project.git
cd my-project

# 查看所有分支（包括远程）
git branch -a

# 切换到远程分支的本地版本
git checkout feature-xyz
```

## 6. 撤销与恢复

### 撤销工作区修改
```bash
# 撤销单个文件的修改
git checkout -- filename.txt

# 撤销所有修改
git checkout -- .
```

### 撤销暂存区修改
```bash
# 将文件从暂存区移回工作区
git reset HEAD filename.txt
```

### 修改最后一次提交
```bash
git commit --amend -m "新的提交信息"
```

### 撤销提交
```bash
# 创建新提交来撤销指定提交（推荐用于已推送的提交）
git revert commit-hash

# 回退到特定提交（危险操作，会重写历史）
git reset --soft commit-hash  # 保留修改在暂存区
git reset --mixed commit-hash # 保留修改在工作区（默认）
git reset --hard commit-hash  # 丢弃所有修改（危险！）
```

### 恢复删除的分支
```bash
# 查找已删除分支的最后一次提交
git reflog

# 基于该提交创建新分支
git checkout -b recovered-branch commit-hash
```

### 撤销操作示例
```bash
# 创建测试文件
echo "原始内容" > test.txt
git add test.txt
git commit -m "添加测试文件"

# 修改文件
echo "错误修改" > test.txt

# 查看状态
git status

# 撤销工作区修改
git checkout -- test.txt

# 再次检查文件内容
cat test.txt  # 显示"原始内容"

# 修改并暂存
echo "暂存的错误修改" > test.txt
git add test.txt

# 从暂存区撤销（但保留工作区修改）
git reset HEAD test.txt
git status

# 提交后修改提交信息
echo "新文件内容" > test2.txt
git add test2.txt
git commit -m "错别字"
git commit --amend -m "添加测试文件2"
```

## 7. 高级操作

### 交互式变基（Interactive Rebase）
```bash
# 对最近的 3 次提交进行变基操作
git rebase -i HEAD~3
```

在打开的编辑器中，您可以：
- `pick` - 保留该提交
- `reword` - 修改提交信息
- `edit` - 修改该提交内容
- `squash` - 将提交合并到前一个提交
- `fixup` - 合并提交，丢弃提交信息
- `drop` - 删除该提交

### 暂存工作（Stashing）
```bash
# 暂存当前更改
git stash

# 查看暂存列表
git stash list

# 应用最近的暂存
git stash apply

# 应用并删除最近的暂存
git stash pop

# 应用特定暂存
git stash apply stash@{2}

# 删除特定暂存
git stash drop stash@{2}

# 清空所有暂存
git stash clear
```

### Git 子模块
```bash
# 添加子模块
git submodule add https://github.com/username/library.git libs/library

# 克隆包含子模块的项目
git clone --recursive https://github.com/username/main-project.git

# 更新子模块
git submodule update --remote
```

### Cherry-pick（拣选提交）
```bash
# 拣选单个提交到当前分支
git cherry-pick commit-hash

# 拣选多个提交
git cherry-pick commit-hash1 commit-hash2
```

## 8. 实际工作场景

### 场景1：功能开发与合并
```bash
# 从主分支创建功能分支
git checkout main
git pull  # 确保主分支是最新的
git checkout -b feature/user-authentication

# 开发功能
# ... (编写代码)
git add .
git commit -m "添加用户登录功能"
# ... (继续开发)
git add .
git commit -m "添加用户注册功能"

# 保持与主分支同步（避免将来合并冲突）
git checkout main
git pull
git checkout feature/user-authentication
git merge main  # 合并主分支到功能分支

# 解决可能的冲突
# ... (解决冲突)
git add .
git commit -m "解决与主分支的冲突"

# 功能完成，准备合并回主分支
git checkout main
git pull
git merge feature/user-authentication
git push
```

### 场景2：紧急修复 Bug
```bash
# 从主分支创建 hotfix 分支
git checkout main
git pull
git checkout -b hotfix/critical-bug

# 修复 bug
# ... (修复代码)
git add .
git commit -m "修复关键错误：登录超时问题"

# 合并到主分支
git checkout main
git pull
git merge hotfix/critical-bug
git push

# 同时将修复也应用到开发中的功能分支
git checkout feature/new-dashboard
git merge hotfix/critical-bug
```

### 场景3：代码审查工作流
```bash
# 克隆仓库
git clone https://github.com/company/project.git
cd project

# 创建功能分支
git checkout -b feature/analytics

# 开发功能
# ... (编写代码)
git add .
git commit -m "实现数据分析界面"

# 推送分支以便提交 PR
git push -u origin feature/analytics

# 收到审查意见后修改
# ... (修改代码)
git add .
git commit -m "根据审查意见调整：优化图表组件"
git push

# 如需合并最近的提交以保持历史整洁
git rebase -i HEAD~2
# 在编辑器中选择 fixup 或 squash

# 强制推送（谨慎使用！只在自己的功能分支上）
git push --force-with-lease
```

### 场景4：发布版本
```bash
# 确保主分支是最新的
git checkout main
git pull

# 创建发布分支
git checkout -b release/v1.2.0

# 最终测试和修复
# ... (测试和小修复)
git add .
git commit -m "准备发布 v1.2.0：最终调整"

# 为发布创建标签
git tag -a v1.2.0 -m "版本 1.2.0"

# 合并到主分支
git checkout main
git merge release/v1.2.0
git push
git push --tags

# 同时合并到开发分支
git checkout develop
git merge release/v1.2.0
git push
```

## 9. Git 最佳实践

### 提交规范
- 使用清晰、描述性的提交信息
- 一个提交专注于一个逻辑变更
- 遵循常见格式，例如：
  ```
  feat: 添加用户注册功能
  fix: 修复登录超时问题
  docs: 更新 API 文档
  style: 格式化代码风格
  refactor: 重构用户验证逻辑
  test: 添加用户注册测试用例
  ```

### 分支管理
- 使用功能分支（`feature/x`）进行新功能开发
- 使用修复分支（`hotfix/x`）进行紧急修复
- 使用发布分支（`release/vX.Y.Z`）准备版本发布
- 定期将主分支合并到功能分支以避免冲突

### 避免常见错误
- 不要在公共分支上使用 `git push --force`
- 创建有意义的提交而不是大量小提交
- 不要提交敏感信息（密码、密钥等）
- 使用 `.gitignore` 排除不应该提交的文件
- 定期清理不再需要的本地和远程分支

### 有用的 Git 配置
```bash
# 设置默认编辑器
git config --global core.editor "code --wait"  # VS Code

# 启用有用的颜色输出
git config --global color.ui true

# 设置 pull 默认行为
git config --global pull.rebase false  # 默认合并
# 或
git config --global pull.rebase true   # 默认变基

# 自动修复拼写错误
git config --global help.autocorrect 1

# 创建别名简化常用命令
git config --global alias.co checkout
git config --global alias.br branch
git config --global alias.st status
git config --global alias.lg "log --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit"
```

---

通过按照这个指南循序渐进地学习和练习，您将能够从 Git 初学者成长为熟练掌握 Git 工作流的开发者。关键是要动手实践每个命令和场景，逐步建立对 Git 的理解和信心。